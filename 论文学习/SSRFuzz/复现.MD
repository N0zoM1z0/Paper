![image-20250610001438318](./å¤ç°/images/image-20250610001438318.png)

![image-20250610001445333](./å¤ç°/images/image-20250610001445333.png)

![image-20250610001452851](./å¤ç°/images/image-20250610001452851.png)

```bash
root@45dcfdddbffe:/SSRFuzz/TaintInfer/verify# ./run.sh
curl "http://localhost:8000/params.php?url=1&nnn=2"
curl "http://localhost:8000/params.php?url=http://www.baidu.com&nnn=2"
```



å¯ä»¥å‘ç°æˆ‘ä»¬çš„urlå‚æ•°è¢«æˆåŠŸæˆªè·ï¼

url=1æ˜¯éæ³•ï¼Œurl=www.baidu.comæ˜¯æ­£å¸¸





---

å››ä¸ªterminalï¼š

fuzzer.py:

![image-20250610102529703](./å¤ç°/images/image-20250610102529703.png)



detector.py:

![image-20250610102514378](./å¤ç°/images/image-20250610102514378.png)



./run.sh:

![image-20250610102549161](./å¤ç°/images/image-20250610102549161.png)



curl:

![image-20250610102605972](./å¤ç°/images/image-20250610102605972.png)



---



taintè¯†åˆ«åˆ°urlå‚æ•°æœ€ç»ˆè§¦å‘äº†sinkï¼Œæ‰€ä»¥å¯¹urlè¿›è¡Œfuzzï¼Œæ›¿æ¢ä¸ºèƒ½å¤Ÿè¢«detectoræ£€æµ‹çš„"url"ï¼Œä¸­é—´åŠ äº†ç»•filterçš„å­—ç¬¦





---

å¦‚æœæ˜¯éœ€è¦å¤šå‚æ•°å…±åŒå†³å®šæœ€ç»ˆçš„sinkç‚¹çš„å‚æ•°ï¼Ÿï¼ˆæ¯”å¦‚ `$a.$b`ï¼‰ <= To Be Check

params.phpæ”¹äº†ä¸‹ï¼š

```php
$result = file_get_contents($url.$nnn);
```

å‘ç°æ£€æµ‹ä¸å‡ºæ¥äº†



paperå®ç°çš„å¥½åƒå°±åªèƒ½æ˜¯å•paramçš„

```python
        if 'query' in self.request and self.request['query']:
            self.fuzz_query() // é‡Œé¢ç”¨çš„fuzz_one_value

        if 'data' in self.request and self.request['data']:
            self.fuzz_body()

```



ç®—ä¸ªæœªæ¥çš„æŒ‘æˆ˜å§



---

substring ç­‰äº identical å—ï¼Ÿ å¦‚æœæ˜¯filterè¿‡åï¼Œä¹Ÿå¯èƒ½å‡ºç°substringğŸ¤”

ooï¼Œæœ‰ä¸ªÎ”len<=3çš„æ£€æµ‹ã€‚ âœ”ï¸





---

fuzzer.py send malicious attack requests and the detector.py as the callback/listener to monitor



---

how fuzzer.py interacts with the dynamic TaintAnalysis stage?

using db to store and read



whenver some parameters reach the sink function, the hooked sink will taintinfer_check_ssrf, in which `  updateVulnType($taintinfer_vuln_type, $fuzz_param);` is used.

the taint stage leaves message about which parameter is vulnerable, narrowing down the input space for fuzzing stage







Q

1. The Multi-Parameter Problem
2. The "Semantic Gap" in Similarity
3. in realworld project vlun mining, how to first start a "manual curl"?

   A: crawler



Expanding:

1. Zend -> JVM
2. SSRF -> RCE, xxx Injection





---

Prof's Q:

1. Tainté‚£å„¿æ˜¯åŠ¨æ€çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼ˆå¦‚ä½•åŒºåˆ†åŠ¨æ€/é™æ€åˆ†ææ–¹æ³•  æ˜¯éœ€è¦æ‰§è¡Œæ¥å…³è”ï¼Œè¿˜æ˜¯ç›´æ¥æºä»£ç åˆ†æï¼‰

   åŠ¨æ€çš„è¯ï¼Œæ€ä¹ˆä¿è¯æ·±åº¦çš„ï¼Ÿè·Ÿfuzz ingä¸€æ ·ï¼Œæœ‰äº›è·¯å¾„æ‰§è¡Œä¸åˆ°æ€ä¹ˆå¤„ç†ï¼Ÿ

2. å¦‚ä½•å®é™…æ¥æµ‹çœŸå®çš„PHP project? å­¦æœ¯è®ºæ–‡çš„ä»£ç å¯é æ€§å¯èƒ½ä¸å¼ºï¼Œæœ‰å¾ˆå¤šå‘

3. çœ‹ä¸‹æœ€æ–°ï¼Œæœ€å‰æ²¿çš„webçš„ä¸€äº›æµ‹è¯•æ¡†æ¶ï¼Œæ¯”å¦‚25å¹´çš„é¡¶ä¼šï¼Œå¤æ—¦æœ‰ä¸ªå›¢é˜Ÿä¹Ÿåšçš„taint analysis





Aï¼š

1. 
   1. Executing the code or notï¼› å®ƒæ˜¯åœ¨ä¸€ä¸ª**è¢«æ’æ¡©çš„ã€æ­£åœ¨è¿è¡Œçš„**Webåº”ç”¨ç¯å¢ƒä¸­è¿›è¡Œçš„ã€‚åŒºåˆ«äºpsalm
   2. ç”¨æ™ºèƒ½çˆ¬è™«crawlgoæ¥ä¿è¯æ·±åº¦
   3. å¯¹æ‰§è¡Œä¸åˆ°çš„è·¯å¾„æ— æ³•å¤„ç†ï¼ŒåŠ¨æ€åˆ†æçš„é€šç—…
